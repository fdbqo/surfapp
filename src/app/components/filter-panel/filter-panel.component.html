<div class="filter-panel-container">
  <!-- Search and filter toggle bar -->
  <div class="search-bar-container">
    <div class="search-input-wrapper">
      <mat-icon class="search-icon">search</mat-icon>
      <input 
        type="text" 
        [formControl]="filterForm.controls.searchTerm" 
        placeholder="Search surf spots..."
        class="search-input"
      >
      <button 
        *ngIf="filterForm.controls.searchTerm.value" 
        class="clear-search-btn" 
        (click)="filterForm.controls.searchTerm.setValue('')"
        matTooltip="Clear search">
        <mat-icon>close</mat-icon>
      </button>
    </div>
    
    <button 
      class="filter-toggle-btn" 
      [class.has-filters]="activeFilterCount > 0"
      [matBadge]="activeFilterCount" 
      [matBadgeHidden]="activeFilterCount === 0"
      matBadgeSize="small"
      matBadgeColor="accent"
      (click)="toggleFilterPanel()"
      matTooltip="Toggle filters">
      <mat-icon>tune</mat-icon>
      <span class="filter-text">Filters</span>
    </button>
  </div>
  
  <!-- Expandable filter panel -->
  <div class="filters-container" [class.expanded]="filterExpanded">
    <div class="filters-header">
      <h3>Filter Surf Spots</h3>
      <button 
        mat-button 
        color="primary" 
        class="clear-all-btn" 
        [disabled]="activeFilterCount === 0"
        (click)="clearFilters()">
        <mat-icon>clear_all</mat-icon>
        Clear All
      </button>
    </div>
    
    <div class="filters-grid">
      <!-- Difficulty -->
      <div class="filter-group" [class.has-active]="getActiveCount('difficulty') > 0">
        <label class="filter-label">
          Difficulty
          <span *ngIf="getActiveCount('difficulty') > 0" class="filter-count">
            ({{getActiveCount('difficulty')}})
          </span>
        </label>
        <mat-form-field appearance="outline">
          <mat-select [formControl]="filterForm.controls.difficulty" multiple>
            <mat-option *ngFor="let level of difficulties" [value]="level">
              {{level}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      
      <!-- Wave Type -->
      <div class="filter-group" [class.has-active]="getActiveCount('waveType') > 0">
        <label class="filter-label">
          Wave Type
          <span *ngIf="getActiveCount('waveType') > 0" class="filter-count">
            ({{getActiveCount('waveType')}})
          </span>
        </label>
        <mat-form-field appearance="outline">
          <mat-select [formControl]="filterForm.controls.waveType" multiple>
            <mat-option *ngFor="let type of waveTypes" [value]="type">
              {{type}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      
      <!-- Region -->
      <div class="filter-group" [class.has-active]="getActiveCount('region') > 0">
        <label class="filter-label">
          Region
          <span *ngIf="getActiveCount('region') > 0" class="filter-count">
            ({{getActiveCount('region')}})
          </span>
        </label>
        <mat-form-field appearance="outline">
          <mat-select [formControl]="filterForm.controls.region" multiple>
            <mat-option *ngFor="let region of allRegions" [value]="region">
              {{region}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      
      <!-- Country -->
      <div class="filter-group" [class.has-active]="getActiveCount('country') > 0">
        <label class="filter-label">
          Country
          <span *ngIf="getActiveCount('country') > 0" class="filter-count">
            ({{getActiveCount('country')}})
          </span>
        </label>
        <mat-form-field appearance="outline">
          <mat-select [formControl]="filterForm.controls.country" multiple>
            <mat-option *ngFor="let country of allCountries" [value]="country">
              {{country}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      
      <!-- Season -->
      <div class="filter-group" [class.has-active]="getActiveCount('season') > 0">
        <label class="filter-label">
          Best Season
          <span *ngIf="getActiveCount('season') > 0" class="filter-count">
            ({{getActiveCount('season')}})
          </span>
        </label>
        <mat-form-field appearance="outline">
          <mat-select [formControl]="filterForm.controls.season" multiple>
            <mat-option *ngFor="let season of seasons" [value]="season">
              {{season}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      
      <!-- Crowd Factor -->
      <div class="filter-group" [class.has-active]="getActiveCount('crowdFactor') > 0">
        <label class="filter-label">
          Crowd Factor
          <span *ngIf="getActiveCount('crowdFactor') > 0" class="filter-count">
            ({{getActiveCount('crowdFactor')}})
          </span>
        </label>
        <mat-form-field appearance="outline">
          <mat-select [formControl]="filterForm.controls.crowdFactor" multiple>
            <mat-option *ngFor="let factor of crowdFactors" [value]="factor">
              {{factor}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </div>
  </div>
</div>

